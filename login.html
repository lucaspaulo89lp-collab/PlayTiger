<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Entrar ‚Äî PlayTiger</title>
  <link rel="stylesheet" href="assets/css/main.css" />
</head>
<body>
  <header class="topbar">
    <div class="container topbar__inner">
      <a class="brand" href="./">
        <span class="brand__mark">üêØ</span>
        <span class="brand__text">PlayTiger</span>
      </a>

      <nav class="nav">
        <a class="nav__link" href="./">Home</a>
        <a class="nav__link" href="dashboard.html">Dashboard</a>
      </nav>

      <div class="wallet">
        <span class="wallet__label" id="hello">Ol√°</span>
        <span class="wallet__value" id="walletTGC">0</span>
        <span class="wallet__unit">TGC</span>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="section">
      <div class="section__head">
        <h1 class="section__title">Entrar</h1>
        <p class="section__desc">Login local (sem senha). Seu nome fica salvo no navegador.</p>
      </div>

      <div class="card" style="max-width:520px;">
        <label class="muted" for="name">Nome do jogador</label>
        <input id="name" autocomplete="nickname"
          style="width:100%;margin:10px 0 12px;padding:12px 14px;border-radius:14px;border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.2);color:#fff;"
          placeholder="Ex: Lucas" />

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn btn--primary" id="btnLogin">Entrar</button>
          <button class="btn btn--ghost" id="btnLogout">Sair</button>
          <a class="btn btn--ghost" href="./">Voltar</a>
        </div>

        <p class="hint" id="msg"></p>
      </div>
    </section>
  </main>

  <script src="assets/js/core.js"></script>
  <script>
    const u = PlayTiger.user.get();
    document.getElementById("hello").textContent = "Ol√°, " + u.name;
    document.getElementById("walletTGC").textContent = PlayTiger.wallet.getTGC();

    const input = document.getElementById("name");
    input.value = (u.isLogged && u.name !== "Visitante") ? u.name : "";

    const msg = document.getElementById("msg");

    document.getElementById("btnLogin").addEventListener("click", () => {
      const r = PlayTiger.user.login(input.value);
      msg.textContent = r.message;
      if (r.ok) setTimeout(() => location.href = "dashboard.html", 350);
    });

    document.getElementById("btnLogout").addEventListener("click", () => {
      PlayTiger.user.logout();
      msg.textContent = "Voc√™ saiu. Agora est√° como Visitante.";
      document.getElementById("hello").textContent = "Ol√°, Visitante";
      input.value = "";
    });

    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") document.getElementById("btnLogin").click();
    });
  </script>
</body>
</html>
